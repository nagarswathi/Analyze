# Web helper: fix execute.py, convert data.xlsx to CSV, and add CI

Overview
This web helper provides:
- A corrected execute.py compatible with Python 3.11+ and Pandas 2.3
- A data.xlsx → data.csv converter (client-side, no upload) to ensure the CSV matches the Excel
- A GitHub Actions workflow (.github/workflows/ci.yml) that:
  - Runs ruff and shows its results in the CI log
  - Runs: python execute.py > result.json
  - Publishes result.json to GitHub Pages
- A .gitignore snippet to avoid committing result.json

Setup
1) Get the files from this helper
- Open index.html in your browser.
- Download:
  - execute.py (fixed)
  - .github/workflows/ci.yml
  - .gitignore (optional but recommended)
- If desired, click “Download project.zip” to get them bundled.

2) Convert data.xlsx to data.csv
- In index.html, drop your data.xlsx to convert it in the browser and download data.csv.
- Alternatively (CLI):
  python - <<'PY'
  import pandas as pd
  pd.read_excel("data.xlsx").to_csv("data.csv", index=False)
  PY

3) Place files in your repository
- Ensure these files exist:
  - execute.py
  - data.xlsx (original attachment)
  - data.csv (converted; content must match data.xlsx)
  - .github/workflows/ci.yml
  - .gitignore (includes result.json)
  - index.html (this helper, optional to keep in repo)
  - README.md (this file)

4) Commit
- Do not commit result.json; it must be generated by CI.
- Example:
  git add execute.py data.csv .github/workflows/ci.yml .gitignore index.html README.md
  git commit -m "Fix execute.py, add CI, add data.csv; result.json generated in CI"
  git push

Usage
- Local run (optional):
  pip install "pandas>=2.3,<2.4" openpyxl ruff
  python execute.py > result.json
  # Inspect result.json locally if desired (but do not commit it)

- CI behavior after push:
  - CI runs ruff and prints findings to the log.
  - CI executes python execute.py > result.json.
  - CI uploads result.json as a Pages artifact and deploys it to GitHub Pages.
  - In the deploy step, GitHub Actions prints the public Pages URL. Navigate to that URL and append /result.json to fetch the generated JSON.

Notes
- execute.py prefers data.csv but will fall back to data.xlsx. This ensures compatibility even if openpyxl is not installed locally; CI installs openpyxl.
- The script fixes the previous bugs:
  - Uses the correct revenue column throughout (no "revenew" typo).
  - Calculates top 3 products by revenue correctly.
  - Computes a 7-day time-based rolling mean of daily revenue per region and returns the last value per region.
- The workflow purposefully does not fail the build on ruff warnings so you can see lint results in the log without blocking deployment. Adjust as needed.